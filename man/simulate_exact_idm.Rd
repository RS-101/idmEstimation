% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_idm.R
\name{simulate_exact_idm}
\alias{simulate_exact_idm}
\title{Simulate Exact Illness-Death Model Data}
\usage{
simulate_exact_idm(
  n,
  a12,
  a13,
  a23,
  t0 = 0,
  tmax = Inf,
  init_step = 1,
  int_abs_tol = 1e-08,
  root_tol = 1e-08,
  max_doublings = 60
)
}
\arguments{
\item{n}{Integer. Number of subjects to simulate.}

\item{a12}{Function of one argument (absolute time \code{t}) giving the hazard
for the 1→2 (healthy to illness) transition.}

\item{a13}{Function of one argument (absolute time \code{t}) giving the hazard
for the 1→3 (healthy to death) transition.}

\item{a23}{Function of one argument (absolute time \code{t}) giving the hazard
for the 2→3 (illness to death) transition. This is a calendar-time hazard.}

\item{t0}{Numeric. Starting time (entry time) for all subjects. Default is 0.}

\item{tmax}{Numeric. Maximum follow-up time. Events occurring after \code{tmax}
are treated as never occurring (set to \code{Inf}). Default is \code{Inf}.}

\item{init_step}{Numeric. Initial step size for the bracketing search in
inversion sampling. Default is 1.}

\item{int_abs_tol}{Numeric. Absolute tolerance for numerical integration
(passed to \code{\link[stats]{integrate}}). Default is 1e-8.}

\item{root_tol}{Numeric. Tolerance for root finding (passed to
\code{\link[stats]{uniroot}}). Default is 1e-8.}

\item{max_doublings}{Integer. Maximum number of bracket doublings allowed
in the search for event times. Default is 60.}
}
\value{
A data frame with class \code{"exact_idm"} containing:
\describe{
\item{id}{Subject ID (1 to \code{n}).}
\item{T_ill}{Time of illness (transition 1→2). \code{Inf} if direct death occurred.}
\item{T_death}{Time of death (transition to state 3).}
\item{path}{Factor indicating the path: \code{"1->3"} (direct death) or
\code{"1->2->3"} (illness then death).}
}
}
\description{
Simulates exact (uncensored) event times from an illness-death model with
arbitrary time-dependent hazard functions. Uses inverse transform sampling
with numerical integration to generate transition times.
}
\details{
The function simulates competing risks from state 1 (healthy) using calendar-time
hazards \code{a12(t)} and \code{a13(t)}. If illness occurs first, the death time
from state 2 is drawn using the calendar-time hazard \code{a23(t)} starting from
the illness time.

Event times are generated via inverse transform sampling: for a hazard \code{h(t)},
the event time \code{T} satisfies \eqn{\int_{t_0}^T h(u) du = E}, where \code{E ~ Exp(1)}.
This integral equation is solved using numerical integration and root finding.
}
\examples{
# Constant hazards
set.seed(123)
exact_data <- simulate_exact_idm(
  n = 100,
  a12 = function(t) rep(0.01, length(t)),
  a13 = function(t) rep(0.005, length(t)),
  a23 = function(t) rep(0.02, length(t))
)
head(exact_data)
table(exact_data$path)

}
\seealso{
\code{\link{add_censoring_type_1}}, \code{\link{simulate_idm}}
}
